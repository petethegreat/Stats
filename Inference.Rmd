--- 
title "simulation and the Central limit theorem: statistical inference course project"
author: "Peter Thompson"
---
# Inference

## Synopsis
something about toothgrowth


### Data Summary

Note the R code used to obtain these results is included in the appendix.

There are 60 observations in the dataset. The length of guinea pig teeth (ondotoblasts) were measured after they had received some dose (either 0.5, 1.0, or 2.0 mg) of vitamen C, which was supplied either as orange juice (OJ) or an aqueous solution of ascorbic acid. (VC). Measurements were taken from 60 guinea pigs, such that each of the six dose/supplement combinations considered was administered to 10 animals. The mean and variance of the measured tooth length is listed below for each group.

 |supp | dose | meanlen | varlen |
 |-----|------|---------|--------|
 |  OJ |  0.5 |  13.23  |19.8890 |
 |  OJ |  1.0 |  22.70  |15.2956 |
 |  OJ |  2.0 |  26.06  | 7.0493 |
 |  VC |  0.5 |   7.98  | 7.5440 |
 |  VC |  1.0 |  16.77  | 6.3268 |
 |  VC |  2.0 |  26.14  |23.0182 |

Initially, it seems that OJ has a larger effect on tooth length, with higher doses correlating with longer tooth lengths. The analysis below will consider these hypotheses and verify whether or not they are statistically significant.

## Analysis

### Supplement form
**check this for language** - we use "statistical significance" a lot. is there a better term for $\alpha$, or something?
Will consider lengths from OJ vs lengths from VC, (neglecting dose). Histograms for these groups are plotted in the appendix

Will use a two group independent (unpaired) t-test, assuming unequal variance (or rather, not assuming equal variance) among groups. Note that the t-test assumes that the observations are normally distributed (although apparently it is 'robust' to this assumption).

In this case, the null hypothesis, $H_0$, is that the mean tooth length for each group is equal. Our alternate hypothesis, $H_a$ is that the means are *not* equal, and thus we will use a two sided t-test. We will require a 95% probability for statistical significance, that is, we will reject the null hypothesis if there is less than a 5\% probability of it producing the observed data.


not sure that we have room to do the math here.

Our two sided independent group, unequal variance t-test has an associated t-statistic of 1.92, with a p-value of 0.06. For this result to be statistically significant at the 95\% level, we require a p-value less than 0.05. This is not the case, and so we accept the null hypothesis, and conclude that the supplement form (OJ vs VC) does not have a significant effect on tooth length.

### Dose Level


hypothesis tests:
OJ is better than VC
higher dose is better
growth per dose?

growth per dose,  (or oj >< VC, two sided)
dosage - test 0.5 vs 2.0, 0.5 vs 1.0, 1.0 vs 2.0
Dosage regardless of method
method regardless of dose
method - growth per unit dose

t distribution assumes data iid normal "but it is robust" to this
unequal variance (the variances above are not equal)
https://github.com/bcaffo/courses/blob/master/06_StatisticalInference/08_tCIs/index.pdf
^ slide 21

Can't use paired test, because we can't compute the differences (we have 60 seperate hamsters, not 10 that were fed vitamin c multiple times via different methods). independent group t intervals (unequal variance), with alternative that the difference is not equal to zero (mu2.0 - mu 0.5)

Go over math in first section/method

analysis section, make a bunch of tests


## Appendix

```{r,load}
library(dplyr)
library(ggplot2)
head(ToothGrowth)
ToothGrowth %>% group_by(supp,dose) %>% summarise(meanlen=mean(len),varlen=var(len))
```

```{r,quicktest}
vc <-ToothGrowth %>% filter(supp=='VC')
oj <-ToothGrowth %>% filter(supp=='OJ')
moose<-t.test(x=oj$len,y=vc$len,paired=F)
moose
```
```{r,plotdose2}
ggplot(data=ToothGrowth,aes(x=len)) + geom_histogram(aes(fill=..count..),binwidth=2) + facet_grid( . ~supp) + scale_fill_gradientn(colours=c('blue','purple')) + guides(fill=F)
```

Check some of this stuff. We're running tests on lots of different subgroups, using the same data more than once. Should we be correcting/accounting for multiple testing?


```{r,dothetests}
doses<-c(0.5,1.0,2.0)

for (i in 1:2)
{
    for (j in (i+1):3)
    {
        print(paste(doses[i],' vs ',doses[j]))
        groupa<- ToothGrowth %>% filter(dose ==doses[i])
        groupb<- ToothGrowth %>% filter(dose ==doses[j])
        test<-t.test(x=groupa$len,y=groupb$len,paired=F)
        print(test)

    }
}
```


```{r,plotdose}
ggplot(data=ToothGrowth,aes(x=len)) + geom_histogram(aes(fill=..count..),binwidth=2) + facet_grid( . ~dose) + scale_fill_gradientn(colours=c('blue','purple')) + guides(fill=F)
```



```{r,binnedsupp}

for (i in 1:3)
{
    ojdose<-ToothGrowth %>% filter(dose == doses[i] ) %>% filter(supp == 'OJ')
    vcdose<-ToothGrowth %>% filter(dose == doses[i] ) %>% filter(supp == 'VC')
    test<-t.test(x=ojdose$len,y=vcdose$len,paired=F)
        print(test)
}


```

```{r,plot}
ggplot(data=ToothGrowth,aes(x=len)) + geom_histogram(aes(fill=..count..),binwidth=2) + facet_grid( supp ~dose) + scale_fill_gradientn(colours=c('blue','purple'))+ guides(fill=F)
```

